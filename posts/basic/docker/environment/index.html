<!doctype html><html><head><title>Environment</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/favicon_huf0eb7d42d3bc5e165d36206de33124ed_44835_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="Docker Environment"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu4fb625795cade1c6e3bcd166157bcd64_68726_42x0_resize_box_2.png>Caifeng</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/site/main-logo_hu4fb625795cade1c6e3bcd166157bcd64_68726_42x0_resize_box_2.png class=d-none id=main-logo>
<img src=/images/site/inverted-logo_huf0eb7d42d3bc5e165d36206de33124ed_44835_42x0_resize_box_2.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/basic/>Basic</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/basic/os/>OS</a><ul><li><a href=/posts/basic/os/linux/>Linux</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/basic/spark/>Spark</a><ul><li><a href=/posts/basic/spark/spark-memory-management/>Spark Memory Management</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/basic/docker/>Docker</a><ul class=active><li><a class=active href=/posts/basic/docker/environment/>Environment</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/interview/>Interview</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/interview/qa/>QA</a><ul><li><a href=/posts/interview/qa/business/>Business</a></li><li><a href=/posts/interview/qa/big-data/>Big Data</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/ai/>AI</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/ai/dl/>DL</a><ul><li><a href=/posts/ai/dl/deep-learning/>Deep Learning</a></li></ul></li><li><a href=/posts/ai/ml/>ML</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/category/>CatÃ©gorie</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/category/sub-category/>Sub-Category</a><ul><li><a href=/posts/category/sub-category/rich-content/>Rich Content</a></li></ul></li></ul></li><li><a href=/posts/markdown-sample/>Markdown Sample</a></li><li><a href=/posts/shortcodes/>Shortcodes Sample</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/test/>Test</a><ul><li><a href=/posts/test/code/>Code</a></li><li><a href=/posts/test/graphic/>Graphic</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://baocaifeng.github.io/images/posts/default-hero.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/caifeng.png><h5 class=author-name>Caifeng Bao</h5><p>March 8, 2021</p></div><div class=title><h1>Environment</h1></div><div class=post-content id=post-content><p>In this post, we are going to see how to deploy a <code>NodeJS</code> blog application to <code>Docker</code> and how to manage docker containers and publish docker images to <code>Docker Hub</code>.</p><blockquote><p><code>NodeJS</code> is a JavaScript runtime environment, widely used and popular for its asynchronous request handling.
<code>Docker</code> is a container management system, used to create and manage containers efficiently.</p></blockquote><p>After reading this post, you will learn:</p><ul><li>xxxxx</li><li>xxxxxxxxxx</li><li>xxxxxxx</li></ul><hr><h1 id=docker>Docker</h1><hr><h2 id=1-install-docker>1. Install Docker</h2><ul><li><mark>Step 1.</mark> Download and install <code>Docker Desktop</code>, then execute it. Create a <code>Docker Hub</code> account if you don&rsquo;t have one, then login to <code>Docker Hub</code>. You will see:</li></ul><p><img src=/img/posts/basic/docker/env/01.png class=center><div style=margin-top:rem></div></p><ul><li><mark>Step 2.</mark> Start <code>Powershell</code> of windows 10, type <code>docker --version</code> to verify that you have well installed <code>Docker Desktop</code>. Then type <code>docker container ls -a</code> to see if there is any container, type <code>docker info</code> to check all the information of docker.</li></ul><p><img src=/img/posts/basic/docker/env/02.png class=center><div style=margin-top:rem></div></p><p><img src=/img/posts/basic/docker/env/03.png class=center><div style=margin-top:rem></div></p><h2 id=2-pull-image>2. Pull Image</h2><ul><li><mark>Step 3.</mark> Visit <a href=https://hub.docker.com/_/node/>Node Docker Official Image</a>, and understand the features of variant node docker images, then choose one image according to your needs. In our case, we will choose <code>alpine</code> image to save disk space. Create a directory named <code>DockerRep</code>, then go to that path and type <code>docker pull node:current-alpine3.13</code>.</li></ul><pre><code class=language-properties data-lang=properties>mkdir DockerRep
cd DockerRep
docker pull node:current-alpine3.13
</code></pre><ul><li>check the downloaded image in docker desktop.</li></ul><p><img src=/img/posts/basic/docker/env/04.png class=center><div style=margin-top:rem></div></p><h2 id=3-start-container>3. Start Container</h2><ul><li><mark>Step 4.</mark> Check the docker images and start the <code>Container</code> from the <code>Image</code> we have pulled. Then verify the container status in <code>Docker Desktop</code>.</li></ul><pre><code class=language-properties data-lang=properties>docker image ls -a
docker container run -it -p 8081:8080 -d --name node-blog-app node:current-alpine3.13
docker container ls -a
</code></pre><blockquote><p>Here:</p><ul><li><code>-it</code>: sets the container in <mark>Interactive</mark> mode and allocate a <mark>Dedicated TTY</mark> id.</li><li><code>-p 8081:8080</code>: <mark>Port</mark> forwarding between <mark>Host</mark> and the <mark>Container</mark>.</li><li><code>-d</code>: sets the container to run in the background.</li><li><code>node-blog-app</code>: name of the <mark>Container</mark> we are starting.</li><li><code>node:current-alpine3.13</code>: name of the <mark>Image</mark> from which we are going to create a <mark>Container</mark></li></ul></blockquote><p><img src=/img/posts/basic/docker/env/05.png class=center><div style=margin-top:rem></div></p><h2 id=4-execute-in-container>4. Execute in Container</h2><ul><li><p><mark>Step 5.</mark> <code>Docker Container</code> is not a <code>Virtual Machine</code> but a <code>Process</code> created from the <code>Image</code>. We can use <code>Interactive Terminal</code> to get into the <code>Container</code>, the flags <code>-it</code> enables this feature. Now we can easily <code>Login</code> to our <code>Container</code> and do all the changes or updates. Once you are into the <code>Container</code>, you can manage it just like you do manage your <code>Linux Virtual Machine</code>, the command supported would vary based on the <code>base OS</code> you have selected while creating the Image. In our case it is <code>alpine</code>.</p></li><li><p>This will create a new Shell session in the container node-blog-app</p></li></ul><pre><code>docker container exec -it node-blog-app &quot;/bin/sh&quot;
</code></pre><p><img src=/img/posts/basic/docker/env/06.png class=center><div style=margin-top:rem></div></p><h2 id=5-docker-commands>5. Docker Commands</h2><pre><code class=language-properties data-lang=properties>docker version   â€“ Echoes Clientâ€™s and Serverâ€™s Version of Docker
docker images   â€“ List all Docker images
docker build &lt;image&gt;   â€“ Builds an image form a Docker file
docker save &lt;path&gt; &lt;image&gt;   â€“ Saves Docker image to .tar file specified by path
docker run   â€“ Runs a command in a new container.
docker start   â€“ Starts one or more stopped containers
docker stop &lt;container_id&gt;   â€“ Stops container
docker rmi &lt;image&gt;   â€“ Removes Docker image
docker rm &lt;container_id&gt;   â€“ Removes Container
docker pull   â€“ Pulls an image or a repository from a registry
docker push   â€“ Pushes an image or a repository to a registry
docker export   â€“ Exports a containerâ€™s filesystem as a tar archive
docker exec   â€“ Runs a command in a run-time container
docker ps   â€“ Show running containers
docker ps -a   â€“ Show all containers
docker ps -l   â€“ Show latest created container
docker search   â€“ Searches the Docker Hub for images
docker attach   â€“ Attaches to a running container
docker commit   â€“ Creates a new image from a containerâ€™s changes
</code></pre><ul><li>Useful Commands</li></ul><pre><code class=language-properties data-lang=properties># copy files from Host to Container or from Container to Host
docker cp src/. my-container:/target
docker cp my-container:/src/. target
</code></pre><hr><h1 id=nodejs---blog-app>NodeJS - (Blog-App)</h1><hr><h2 id=1-docker-as-dev-environment>1. Docker As Dev Environment</h2><p>As we all know, <code>Docker</code> is a system designed to create, deploy and run applications by using containers. Containers allow us to package all libraries, dependencies as well as the source code of an application into an image, others can get exactly what we have in the container by clone and execute the image.</p><p>According to <code>Docker</code> features, we can use it as local or remote development environment. When we handle more than one projects, all of them use different dependencies or versions of libraries, it&rsquo;s very hard to manage different working environments in your machine, so that&rsquo;s why we want to use docker container to host our <code>Blog-App</code>.</p><p>In this part, we will store the source code and the needed data in the disk of local machine (<code>Host</code>), and share this disk with the <code>Container</code>. Then we can create or modify the source code, add or delete the needed data in the <code>Host</code>, and run the application in the <code>Container</code>. Because the disk of the <code>Host</code> is mounted to the <code>Container</code>, our source code and data can be synchronized automatically. After running the application, we can see results in the <code>Browser</code> of the <code>Host</code> in the <code>Port 8081</code> because we bind the <code>8081 Port</code> of the <code>Host</code> to <code>Virtual 8080 Port</code> of the <code>Container</code> before.</p><p>The figures below show the structure of how to use <code>Docker</code> as <mark>local (or remote)</mark> development environments.</p><p><img src=/img/posts/basic/docker/env/07.png class=center><div style=margin-top:rem></div></p><p><img src=/img/posts/basic/docker/env/08.png class=center><div style=margin-top:rem></div></p><h2 id=2-mount-directory-to-share-data-between-host-and-container>2. Mount Directory to share data between <code>Host</code> and <code>Container</code></h2><p>In windows, we can&rsquo;t use <code>docker volume create --driver local</code> to create <code>Docker Volume</code>, if you use linux, please reference <a href=https://docs.docker.com/engine/reference/commandline/volume_create/>this</a>. So, we mount the <code>Directory</code> of the <code>Host</code> directly to the <code>Container</code>.</p><ul><li><mark>Step 6.</mark> Stop and remove the <code>node-blog-app</code> container to avoid conflicts.</li></ul><pre><code class=language-properties data-lang=properties># stop and remove container
docker container stop node-blog-app
docker container rm node-blog-app
# or: remove all stopped containers
docker container prune
# verify 
docker container ls -a
</code></pre><ul><li><mark>Step 7.</mark> Create the <code>node-blog-app</code> container from <code>node:current-alpine3.13</code> image again and mount <code>source code</code> or <code>data</code> directory of the <code>Host</code> to the <code>node-blog-app</code> container.</li></ul><pre><code class=language-properties data-lang=properties># in DockerRep directory, create a blog-app folder, and put a README.md file in it
# the blog-app folder in Host, is the repository of our source code, you can also manage it with git

# create container
docker container run -it -p 8081:8080 -v &quot;$(pwd)/blog-app:/mnt/data,readonly&quot; -d --name node-blog-app node:current-alpine3.13

docker ps

# check the source code folder
ls blog-app
</code></pre><blockquote><p>Here:</p><ul><li><code>-v /host-directory:/container-directory,readonly</code>: represents to mount host directory into container directory, <code>readonly</code> is optional, means the container can only read the files in shared directory. This will secure our source code and save computing resources when we modify the source code frequently in host machine.</li></ul></blockquote><p><img src=/img/posts/basic/docker/env/09.png class=center><div style=margin-top:rem></div></p><ul><li><mark>Step 8.</mark> Develop <mark>Blog-App</mark> in the host as usual.</li></ul><!doctype html><html><head><title></title><style>div.scroll{background-color:blank;width:100%;height:200px;overflow-x:auto;overflow-y:auto;text-align:center;padding:200px auto}</style></head><body><h3>blog-app tree</h3><div class=scroll><img src=/img/posts/basic/docker/env/10.png align=center></div></body></html><ul><li><mark>Step 9.</mark> In <code>node-blog-app</code> container, copy the <code>source code</code> from <code>shared readonly directory</code> to your <code>workspace</code> directory. We use <code>/home/node/blog-app</code> as workspace directory. Install <code>blog-app</code> and start <code>node</code> server.</li></ul><pre><code class=language-properties data-lang=properties># in container
mkdir /home/node/blog-app
cd /home/node/blog-app
cp -rf /mnt/data*/*  .
ls
</code></pre><h2 id=other-elements--abbr-sub-sup-kbd-mark>Other Elements â€” abbr, sub, sup, kbd, mark</h2><p><abbr title="Graphics Interchange Format">GIF</abbr> is a bitmap image format.</p><p>H<sub>2</sub>O</p><p>X<sup>n</sup> + Y<sup>n</sup> = Z<sup>n</sup></p><p>Press <kbd><kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>Delete</kbd></kbd> to end the session.</p><p><kbd>hello</kbd>
Most <mark>salamanders</mark> are nocturnal, and hunt for insects, worms, and other small creatures.</p><hr><h2 id=math-rendering>Math Rendering</h2><p>Block math:
$$
\varphi = 1+\frac{1} {1+\frac{1} {1+\frac{1} {1+\cdots} } }
$$</p><hr><h2 id=emoji-rendering>Emoji Rendering</h2><p><span class=nowrap><span class=emojify>ðŸ™ˆ</span> <code>ðŸ™ˆ</code></span> <span class=nowrap><span class=emojify>ðŸ™‰</span> <code>ðŸ™‰</code></span> <span class=nowrap><span class=emojify>ðŸ™Š</span> <code>ðŸ™Š</code></span></p><br></div><div class=btn-improve-page><a href=https://github.com/baocaifeng/Homepage/edit/master/02_gohugo_site/content/posts/Basic/Docker/Environment/index.en.md><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/test/code/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>Code</span></a></div></div><hr><div id=utteranc_thread></div><script src=https://utteranc.es/client.js repo=baocaifeng/baocaifeng.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the
<a href=https://utteranc.es/>comments powered by Utteranc.</a></noscript><a href=https://utteranc.es/ class=utteranc-brlink>commentst powered by
<span class=logo-disqus>Utteranc</span></a></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#1-install-docker>1. Install Docker</a></li><li><a href=#2-pull-image>2. Pull Image</a></li><li><a href=#3-start-container>3. Start Container</a></li><li><a href=#4-execute-in-container>4. Execute in Container</a></li><li><a href=#5-docker-commands>5. Docker Commands</a></li></ul><ul><li><a href=#1-docker-as-dev-environment>1. Docker As Dev Environment</a></li><li><a href=#2-mount-directory-to-share-data-between-host-and-container>2. Mount Directory to share data between <code>Host</code> and <code>Container</code></a></li><li><a href=#other-elements--abbr-sub-sup-kbd-mark>Other Elements â€” abbr, sub, sup, kbd, mark</a></li><li><a href=#math-rendering>Math Rendering</a></li><li><a href=#emoji-rendering>Emoji Rendering</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>caifeng.b@gmail.com</span></li><li><span>Github:</span> <span>http://</span></li><li><span>Homepage:</span> <span>http://</span></li><li><span>Linkdin:</span> <span>http://</span></li><li><span>Phone:</span> <span>+0123456789</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class="col-md-4 text-left"><a href=# target=_self><img src=/images/site/hand-logo_hubf75e9d66f35cacee53a00cc45d2f7f3_38878_32x0_resize_box_2.png height=32>
Back to Top</a></div><div class="col-md-4 text-center">Â© 2021 Copyright</div><div class="col-md-4 text-right"><a id=mainlogo href=https://github.com/baocaifeng target=_blank>Powered by
<img src=/images/site/main-logo_hu4fb625795cade1c6e3bcd166157bcd64_68726_32x0_resize_box_2.png height=32></a></div></div></div></footer><link rel=stylesheet href=/css/chatbot.css><script src=/js/jquery-3.4.1.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9/core.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9/sha256.js></script><div><div id=chatbot><img src=/images/author/caifeng.png style=border:none;border-radius:50%;width:80px></div></div><div id=chatbox><p>hello from chatbot</p><form><input type=text name=token id=token value="Your Bot Token">
<input type=text name=chat_id id=chat_id value="Your Chat ID">
<input type=text name=text id=text value=hello>
<input type=submit value=submit></form></div><script type=text/javascript>$(document).ready(function(){function a(){console.log("ok")}a(),$('form').submit(function(a){a.preventDefault(),$.ajax({url:'https://api.telegram.org/bot'+$('#token').val()+'/sendMessage',method:'POST',data:{chat_id:$('#chat_id').val(),text:$('#text').val()},success:function(){alert('your message has been sent!')}})}),$('#unlock').click(function(){var a=CryptoJS.SHA256($('#access').val()).toString();a==""?$('#overlay').fadeOut(300):(window.alert("wrong access code !"),$('#access').val(''))}),$('#cancle').click(function(){window.history.back()})})</script><script src=/js/jquery-3.4.1.min.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/navbar.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></body></html>